<!DOCTYPE html>
<html lang="it">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>TIM Telecom Italia Mobile</title>
		<meta name="description" content="">
		<meta name="author" content="">
		<!--link rel="icon" href="../../favicon.ico"-->
		
		<!-- Bootstrap core CSS -->
		<link href="css/bootstrap.css" rel="stylesheet">

		<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
		<link href="css/ie10-viewport-bug-workaround.css" rel="stylesheet">

		<link href="css/general.css" rel="stylesheet">

		<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
		<!--[if lt IE 9]>
		  <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
		  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
		<![endif]-->
		<!-- Bootstrap core JavaScript
		================================================== -->
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
		<script>window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')</script>
		<script src="js/bootstrap.min.js"></script>
		<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
		<script src="js/ie10-viewport-bug-workaround.js"></script>
		<script src="js/general.js"></script>
	</head>
	<body>
		<div id="divNavbar">
		</div>
		<div class="container">
			<div class="col-md-4 col-xs-12">
				<div id="navigationBackToCategory" class="col-md-12 col-xs-12" style="clear: both;">
					<a href="#"><p class="alignleft">< Smartphone</p></a>
				</div>
				<div id="navigationBackToPromo" class="col-md-12 col-xs-12" style="clear: both;">
					<a href="#"><p class="alignleft">< Promozioni</p></a>
				</div>
				<div id="navigationBackToService" class="col-md-12 col-xs-12" style="clear: both;">
					<a href="#"><p class="alignleft">< Servizio Assistenza</p></a>
				</div>
				<div id="navigationBackToSLService" class="col-md-12 col-xs-12" style="clear: both;">
					<a href="#"><p class="alignleft">< SL Service</p></a>
				</div>
				<div id="myCarousel" class="carousel slide" data-ride="carousel">
					<!-- Indicators -->
					<ol class="carousel-indicators" id="dataImgCarOL">
					</ol>

					<!-- Wrapper for slides -->
					<div class="carousel-inner" role="listbox" id="dataCarItems">
					</div>
				</div>
				<div id="modalImages">
				</div>
			</div>
			<div class="col-md-8 col-xs-12">
				<div id="navigation" class="col-md-12 col-xs-12" style="clear: both;">
					<a href="#" id="aPrevInCat"><p class="alignleft"><< Precedente</p></a>
					<a href="#" id="aNextInCat"><p class="alignright">Successivo >></p></a>
				</div>
				<div class="col-md-12 col-xs-12 navigationPromo" style="clear: both;">
					<a href="#" id="aPrevInPromo"><p class="alignleft"><< Precedente in Promozione</p></a>
					<a href="#" id="aNextInPromo"><p class="alignright">Successivo in Promozione >></p></a>
				</div>
				<div id="divNomeProdotto">
					<h1 id="dataNomeProdotto"></h1>
				</div>
				<div class="col-md-3 prezzo">
					<br><p id="dataPrezzo"></p>
				</div>
				<div class="col-md-4" id="specifiche">
					<h4>Specifiche prodotto:</h4>
					<ul id="dataSpecUl">
					</ul>
				</div>
				<div id="prodTabs" class="col-md-9 col-xs-12">
					<ul class="nav nav-tabs">
					  <li class="active smallTabText"><a data-toggle="tab" href="#home">Descrizione</a></li>
					  <li class="smallTabText"><a data-toggle="tab" href="#menu1">Scheda Tecnica</a></li>
					  <li class="smallTabText"><a data-toggle="tab" href="#menu2">Servizi associati</a></li>
					  <li class="smallTabText"><a data-toggle="tab" href="#faq">FAQ</a></li>
					</ul>
								
					<div class="tab-content">
					  <div id="home" class="tab-pane fade in active">
						<h3>Descrizione</h3>
						<p id="dataDescrizione"></p>
					  </div>
					<div id="menu1" class="tab-pane fade">
						<h3>Scheda Tecnica</h3>
						<p id="dataSchedaTecnica"></p>                  
					</div>
					<div id="menu2" class="tab-pane fade">
						<h3>Servizi Associati</h3>
						<p></p>                  
					</div>
					<div id="faq" class="tab-pane fade">
						<h3>FAQ</h3>
						<p></p>        
					</div>
					</div>
				</div>
			</div>
		</div>
		<script>
			var promoYes = '&getpromo=1';
			var promoNo = '';
			var carImg = '<div class="item"><a class="product-modal" data-toggle="modal" data-target="" href="#"><img src="media/test_iphone0_small.jpg" alt=""></a></div>';
			var modalImg = '<div class="modal fade toSetClass" tabindex="-1" role="dialog" aria-labelledby="productModal"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-body"><img class="modal-img img-responsive" src="" alt=""></div></div></div></div>';
			function loadProduct(pid,promo){
				// Get data from DB
				$.ajax({
					url: mySite+'dojson.php?get=singleproduct&pid='+pid+promo,
					method: 'GET',
					dataType: 'json'
				}).done(function(data){
					console.log(data);
					
					if(data['prevInCat'] != undefined)
						$('#aPrevInCat').unbind('click').click(function(){loadProduct(data['prevInCat'],promoNo)})
					
					if(data['nextInCat'] != undefined)
						$('#aNextInCat').unbind('click').click(function(){loadProduct(data['nextInCat'],promoNo)})
					
					$('#dataNomeProdotto').html(data['nome']);
					$('#dataPrezzo').html(data['prezzo'].toFixed(2) +'&euro;');
					$('#dataSpecUl').html('');
					$('#dataSpecUl').append('<li>'+data['spec1']+'</li>');
					$('#dataSpecUl').append('<li>'+data['spec2']+'</li>');
					$('#dataSpecUl').append('<li>'+data['spec3']+'</li>');
					$('#dataSpecUl').append('<li>'+data['spec4']+'</li>');
					$('#dataDescrizione').html(data['descrizione']);
					$('#dataSchedaTecnica').html(data['schedaTecnica']);
					$('#dataCarItems').html('');
					$('#dataImgCarOL').html('');
					$('#modalImages').html('');
					if(data['immagini']){
						var counter =0;
						$.each(data['immagini'],function(i,v){
							$('#dataCarItems').append(carImg).find('.product-modal').last().attr('data-target','.modalImg'+counter).find('img').last().attr('src',imgPathProduct+v['src']);
							$('#dataImgCarOL').append('<li data-target="#myCarousel" data-slide-to="'+counter+'"></li>');
							$('#modalImages').append(modalImg).find('.toSetClass').removeClass('toSetClass').addClass('modalImg'+counter).find('img').last().attr('src',imgPathProduct+v['src']).attr('id','modalImg'+counter);
							counter++;
						});
						$('#dataCarItems').find('.item').first().addClass('active');
						$('#myCarousel ol').find('li').first().addClass('active');
					}

					// Next and Prev promotions link
					if(promo != ''){
						if(data['promoPrev'] != undefined)
							$('#aPrevInPromo').unbind('click').click(function(){loadProduct(data['promoPrev'],promoYes)});
						if(data['promoNext'] != undefined)
							$('#aNextInPromo').unbind('click').click(function(){loadProduct(data['promoNext'],promoYes)});
					}
					
					// Back to SL link
					if(getURLParameter('fromSL') != null)
						$('#navigationBackToSLService').attr('href','sl_service.html?sid='+getURLParameter('fromSL')); 

					}).fail(function(){
					alert('Oops, that is an error!');
				});
				
				// return statement for links
				return false;
			}
			$(function(){
				var pid = getURLParameter('pid');
				var promo = (getURLParameter('promo') != null) ? promoYes:'';
				loadProduct(pid,promo);
			});
		</script>
		<div id="divFooter">
		</div>
	</body>
</html>